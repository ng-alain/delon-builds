(self.webpackChunkdelon=self.webpackChunkdelon||[]).push([[162],{1162:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FormPagesModule:()=>U});var o=n(3423),i=n(7716),s=n(665),r=n(8583),a=n(2759),c=n(4395);const l=new i.OlP("NU_MONACO_EDITOR_CONFIG");let h,d=!1,u=(()=>{class e{constructor(e,t,n,o){this.el=e,this.doc=n,this.ngZone=o,this._resize$=null,this._disabled=!1,this.height="200px",this.delay=0,this.event=new i.vpe,this._config=Object.assign({baseUrl:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min"},t),this.options=this._config.defaultOptions}set disabled(e){this._disabled="string"==typeof e||e,this.setDisabled()}set options(e){this._options=Object.assign(Object.assign({},this._config.defaultOptions),e)}get options(){return this._options}initMonaco(e,t){}notifyEvent(e,t){this.ngZone.run(()=>this.event.emit(Object.assign({type:e,editor:this._editor},t)))}setDisabled(){return this._editor&&this._editor.updateOptions({readOnly:this._disabled}),this}init(){d?h.then(()=>this.initMonaco(this.options,!0)):(d=!0,h=new Promise((e,t)=>{const n=window;if(null==n)return void e();if(n.monaco)return void e();const o=this._config.baseUrl,i=()=>{n.require.config({paths:{vs:`${o}/vs`}}),n.require(["vs/editor/editor.main"],()=>{"function"==typeof this._config.monacoLoad&&this._config.monacoLoad(n.monaco),this.initMonaco(this.options,!0),e()},()=>{t("Unable to load editor/editor.main module, please check your network environment.")})};if(n.require)i();else{const e=this.doc.createElement("script");e.type="text/javascript",e.src=`${o}/vs/loader.js`,e.onload=i,e.onerror=()=>t(`Unable to load ${e.src}, please check your network environment.`),this.doc.getElementsByTagName("head")[0].appendChild(e)}}).catch(e=>this.notifyEvent("load-error",{error:e})))}cleanResize(){return this._resize$&&this._resize$.unsubscribe(),this}registerResize(){return this.cleanResize(),this._resize$=(0,a.R)(window,"resize").pipe((0,c.b)(100)).subscribe(()=>{this._editor.layout(),this.notifyEvent("resize")}),this}updateOptions(){this._editor&&this.ngZone.runOutsideAngular(()=>{this._editor.dispose(),this.initMonaco(this._options,!1)})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>setTimeout(()=>this.init(),+this.delay))}ngOnChanges(e){const t=Object.keys(e);1===t.length&&"disabled"===t[0]||this.updateOptions()}ngOnDestroy(){this.cleanResize(),this._editor&&(this._editor.dispose(),this._editor=void 0)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.SBq),i.Y36(l),i.Y36(r.K0),i.Y36(i.R0b))},e.\u0275cmp=i.Xpm({type:e,selectors:[["nu-monaco-base"]],inputs:{height:"height",delay:"delay",disabled:"disabled",options:"options"},outputs:{event:"event"},features:[i.TTD],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),m=(()=>{class e extends u{constructor(){super(...arguments),this._value="",this.onChange=e=>{},this.onTouched=()=>{}}get editor(){return this._editor}initMonaco(e,t){const n=!!this.model;if(n){const t=monaco.editor.getModel(this.model.uri||"");if(t)e.model=t,e.model.setValue(this._value);else{const{value:t,language:n,uri:o}=this.model;e.model=monaco.editor.createModel(t||this._value,n,o)}}e.readOnly=this._disabled;const o=this._editor=monaco.editor.create(this.el.nativeElement,e);n||o.setValue(this._value),o.onDidChangeModelContent(()=>{const e=o.getValue();this.ngZone.run(()=>{this._value=e,this.onChange(e)})}),o.onDidBlurEditorWidget(()=>this.onTouched()),this.registerResize(),o.getAction("editor.action.formatDocument").run().then(()=>this.notifyEvent(t?"init":"re-init"))}writeValue(e){this._value=e||"",this._editor&&this._editor.setValue(this._value)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this.setDisabled()}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=i.n5z(e)))(n||e)}}(),e.\u0275cmp=i.Xpm({type:e,selectors:[["nu-monaco-editor"]],hostVars:4,hostBindings:function(e,t){2&e&&i.Udp("display","block")("height",t.height)},inputs:{model:"model"},exportAs:["nuMonacoEditor"],features:[i._Bn([{provide:s.JU,useExisting:(0,i.Gpc)(()=>e),multi:!0}]),i.qOj],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e})(),p=(()=>{class e{static forRoot(t){return{ngModule:e,providers:[{provide:l,useValue:t}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[r.ez]]}),e})();var g=n(7465),f=n(110),z=n(9765),b=n(6782),v=n(3466),C=n(6080),y=n(6069),Z=n(1807),T=n(8058),_=n(6704),O=n(269),x=n(1398),M=n(4453),S=n(4514),J=n(9374),A=n(7420),q=n(7828),w=n(4828),D=n(4927),E=n(2567);const k=["schemaEditor"],N=["formCodeEditor"],Q=["uiEditor"];function $(e,t){if(1&e&&i._UZ(0,"nz-option",24),2&e){const e=t.$implicit;i.Q6J("nzValue",e.name)("nzLabel",e.title)}}function V(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"sf",25),i.NdJ("formSubmit",function(t){return i.CHM(e),i.oxw().submit(t)})("formChange",function(t){return i.CHM(e),i.oxw().change(t)})("formValueChange",function(t){return i.CHM(e),i.oxw().valueChange(t)})("formError",function(t){return i.CHM(e),i.oxw().error(t)}),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.Q6J("nzSpan",e.expand?12:24),i.xp6(1),i.Q6J("schema",e.schemaData)("formData",e.formData)("ui",e.uiSchema)("layout",e.layout)}}const j=[{path:"",component:g.S,children:[{path:"validator/:lang",component:(()=>{class e{constructor(e,t,n,o,i,s){this.i18n=e,this.codeSrv=t,this.http=n,this.msg=o,this.appService=i,this.cdr=s,this.destroy$=new z.xQ,this.files=[{name:"basic",title:"\u57fa\u672c"},{name:"conditional",title:"\u6761\u4ef6"},{name:"sort",title:"\u987a\u5e8f"},{name:"validation",title:"\u81ea\u5b9a\u4e49\u6821\u9a8c"},{name:"fixed",title:"\u4e0d\u89c4\u5219\u5e03\u5c40"}],this.layout="horizontal",this.expand=!0,this.editorOptions={language:"json",theme:"vs"},this.name=this.files[0].name,this.title=this.files[0].title,this.appService.theme$.pipe((0,b.R)(this.destroy$)).subscribe(e=>{this.editorOptions={language:"json",theme:"dark"===e?"vs-dark":"vs"}})}ngOnInit(){this.getSchema()}refreshLayout(e){setTimeout(()=>{this[e].editor.layout()},100)}getSchema(){const e=this.files.find(e=>e.name===this.name);if(e){if(this.name=e.name,this.title=e.title,e.cache)return this.schema=e.cache,void this.run();this.http.get(`./assets/schema/${e.name}.json`,null,{responseType:"text"}).subscribe(t=>{e.cache=t,this.schema=e.cache,this.run()})}}run(){this.schemaData=JSON.parse(this.schema||"{}"),this.formData=JSON.parse(this.formCode||"{}"),this.uiSchema=JSON.parse(this.uiCode||"{}"),this.cdr.detectChanges()}openOnStackBlitz(){const e={schema:this.schema,layout:this.layout,formData:this.formCode||"{}",ui:this.uiCode||"{}"},t="\nimport { Component } from '@angular/core';\nimport { SFSchema } from '@delon/form';\nimport { NzMessageService } from 'ng-zorro-antd/message';\n\n@Component({\n  selector: 'demo',\n  template: `\n  <sf [schema]=\"schema\" [formData]=\"formData\" [ui]=\"ui\" [layout]=\"layout\"\n      (formSubmit)=\"submit($event)\"\n      (formChange)=\"change($event)\"\n      (formError)=\"error($event)\"></sf>\n    `\n})\nexport class DemoComponent {\n  schema = {schema};\n  formData = {formData};\n  ui = {ui};\n  layout = '{layout}';\n\n  constructor(private msg: NzMessageService) { }\n\n  submit(value: any) {\n    this.msg.success(JSON.stringify(value));\n  }\n\n  change(value: any) {\n    console.log('formChange', value);\n  }\n\n  error(value: any) {\n    console.log('formError', value);\n  }\n}".replace(/\{(\w+)\}/g,(t,n)=>(e[n]||"").trim());this.codeSrv.openOnStackBlitz(t)}onCopy(){(0,C.JG)(this.schema).then(()=>this.msg.success(this.i18n.fanyi("app.demo.copied")))}submit(e){this.msg.success(JSON.stringify(e))}change(e){console.log("formChange",e)}valueChange(e){console.log("formChange",e)}error(e){console.log("formError",e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(v.Oi),i.Y36(y.$),i.Y36(v.lP),i.Y36(T.dD),i.Y36(Z.z),i.Y36(i.sBO))},e.\u0275cmp=i.Xpm({type:e,selectors:[["form-validator"]],viewQuery:function(e,t){if(1&e&&(i.Gf(k,5),i.Gf(N,5),i.Gf(Q,5)),2&e){let e;i.iGM(e=i.CRH())&&(t.schemaEditor=e.first),i.iGM(e=i.CRH())&&(t.formCodeEditor=e.first),i.iGM(e=i.CRH())&&(t.uiEditor=e.first)}},decls:34,vars:23,consts:[["nz-row","",1,"border-bottom-1","pb-sm","mb-md"],["nz-col","",3,"nzSpan"],[3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"ml-sm",3,"ngModel","ngModelChange"],["nz-radio-button","","nzValue","horizontal"],["nz-radio-button","","nzValue","vertical"],["nz-radio-button","","nzValue","inline"],["nz-col","",1,"text-right",3,"nzSpan"],["nz-tooltip","","nz-button","",3,"nzTooltipTitle","click"],["nz-icon","",3,"nzType"],["nz-tooltip","","nz-button","",1,"ml-sm",3,"nzTooltipTitle","click"],["nz-icon","","nzType","form"],["nz-icon","","nzType","copy"],["nz-row","",1,"border-bottom-1","pb-sm","mb-md",3,"nzGutter"],["nz-col","",3,"nzSpan","hidden"],["nzTitle","Schema",3,"nzClick"],["height","500px",3,"ngModel","options","ngModelChange"],["schemaEditor",""],["nzTitle","Form Data",3,"nzClick"],["formCodeEditor",""],["nzTitle","UI Schema",3,"nzClick"],["uiEditor",""],["nz-col","",3,"nzSpan",4,"ngIf"],[3,"nzValue","nzLabel"],[3,"schema","formData","ui","layout","formSubmit","formChange","formValueChange","formError"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"nz-select",2),i.NdJ("ngModelChange",function(e){return t.name=e})("ngModelChange",function(){return t.getSchema()}),i.YNc(3,$,1,2,"nz-option",3),i.qZA(),i.TgZ(4,"nz-radio-group",4),i.NdJ("ngModelChange",function(e){return t.layout=e}),i.TgZ(5,"label",5),i._uU(6,"\u6c34\u5e73"),i.qZA(),i.TgZ(7,"label",6),i._uU(8,"\u5782\u76f4"),i.qZA(),i.TgZ(9,"label",7),i._uU(10,"\u884c\u5185"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(11,"div",8),i.TgZ(12,"nz-button-group"),i.TgZ(13,"button",9),i.NdJ("click",function(){return t.expand=!t.expand}),i._UZ(14,"i",10),i.qZA(),i.TgZ(15,"button",11),i.NdJ("click",function(){return t.openOnStackBlitz()}),i.ALo(16,"i18n"),i._UZ(17,"i",12),i.qZA(),i.TgZ(18,"button",11),i.NdJ("click",function(){return t.onCopy()}),i.ALo(19,"i18n"),i._UZ(20,"i",13),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(21,"div",14),i.TgZ(22,"div",15),i.TgZ(23,"nz-tabset"),i.TgZ(24,"nz-tab",16),i.NdJ("nzClick",function(){return t.refreshLayout("schemaEditor")}),i.TgZ(25,"nu-monaco-editor",17,18),i.NdJ("ngModelChange",function(e){return t.schema=e})("ngModelChange",function(){return t.run()}),i.qZA(),i.qZA(),i.TgZ(27,"nz-tab",19),i.NdJ("nzClick",function(){return t.refreshLayout("formCodeEditor")}),i.TgZ(28,"nu-monaco-editor",17,20),i.NdJ("ngModelChange",function(e){return t.formCode=e})("ngModelChange",function(){return t.run()}),i.qZA(),i.qZA(),i.TgZ(30,"nz-tab",21),i.NdJ("nzClick",function(){return t.refreshLayout("uiEditor")}),i.TgZ(31,"nu-monaco-editor",17,22),i.NdJ("ngModelChange",function(e){return t.uiCode=e})("ngModelChange",function(){return t.run()}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.YNc(33,V,2,5,"div",23),i.qZA()),2&e&&(i.xp6(1),i.Q6J("nzSpan",18),i.xp6(1),i.Q6J("ngModel",t.name),i.xp6(1),i.Q6J("ngForOf",t.files),i.xp6(1),i.Q6J("ngModel",t.layout),i.xp6(7),i.Q6J("nzSpan",6),i.xp6(2),i.Q6J("nzTooltipTitle",t.expand?"Hide Code":"Show Code"),i.xp6(1),i.MGl("nzType","vertical-",t.expand?"right":"left",""),i.xp6(1),i.Q6J("nzTooltipTitle",i.lcZ(16,19,"app.demo.stackblitz")),i.xp6(3),i.Q6J("nzTooltipTitle",i.lcZ(19,21,"app.demo.copy")),i.xp6(3),i.Q6J("nzGutter",24),i.xp6(1),i.Q6J("nzSpan",12)("hidden",!t.expand),i.xp6(3),i.Q6J("ngModel",t.schema)("options",t.editorOptions),i.xp6(3),i.Q6J("ngModel",t.formCode)("options",t.editorOptions),i.xp6(3),i.Q6J("ngModel",t.uiCode)("options",t.editorOptions),i.xp6(2),i.Q6J("ngIf",t.schemaData))},directives:[_.SK,_.t3,O.Vq,s.JJ,s.On,r.sg,x.Dg,x.Of,x.Bq,M.fY,S.w,M.ix,J.dQ,A.SY,q.Ls,w.xH,w.xw,m,r.O5,O.Ip,D.k],pipes:[E.C],encapsulation:2,changeDetection:0}),e})(),data:{titleI18n:"app.header.menu.form.validator"}}]}];let U=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[f.m,p.forRoot({defaultOptions:{scrollBeyondLastLine:!1}}),o.Bz.forChild(j)]]}),e})()}}]);