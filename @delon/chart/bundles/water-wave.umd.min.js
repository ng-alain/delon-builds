/**
 * @license ng-alain(cipchk@qq.com) v9.0.0-alpha.1
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@delon/util"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/chart/water-wave",["exports","@angular/core","@delon/util","rxjs","rxjs/operators","@angular/common"],t):t(((e=e||self).delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart["water-wave"]={}),e.ng.core,e.delon.util,e.rxjs,e.rxjs.operators,e.ng.common)}(this,(function(e,t,n,r,i,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function a(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var h=function(){function e(e,t,n,r){this.el=e,this.renderer=t,this.ngZone=n,this.cdr=r,this.resize$=null,this.delay=0,this.color="#1890FF",this.height=160}return e.prototype.renderChart=function(e){if(this.resize$){this.updateRadio();var t=this.percent,n=this.color,r=this.node,i=Math.min(Math.max(t/100,0),100),o=this;cancelAnimationFrame(this.timer);var a=r.nativeElement,s=a.getContext("2d"),l=a.width,c=a.height,h=l/2,u=h-2;s.beginPath(),s.lineWidth=4;for(var p=l-2,d=p/8,f=.2,g=0,v=0,y=[],m=h-2,w=-Math.PI/2,b=!0,x=w;x<w+2*Math.PI;x+=1/(8*Math.PI))y.push([h+m*Math.cos(x),h+m*Math.sin(x)]);var C=y.shift();s.strokeStyle=n,s.moveTo(C[0],C[1]),function t(){if(s.clearRect(0,0,l,c),b&&"update"!==e)if(y.length){var r=y.shift();s.lineTo(r[0],r[1]),s.stroke()}else b=!1,s.lineTo(C[0],C[1]),s.stroke(),y=null,s.globalCompositeOperation="destination-over",s.beginPath(),s.lineWidth=2,s.arc(h,h,m,0,2*Math.PI,!0),s.beginPath(),s.save(),s.arc(h,h,h-6,0,2*Math.PI,!0),s.restore(),s.clip(),s.fillStyle=n;else{if(i>=.85){if(f>.05)f-=.002}else if(i<=.1){if(f<.2*1.5)f+=.002}else{if(f<=.2)f+=.002;if(f>=.2)f-=.002}i-v>0&&(v+=.005),i-v<0&&(v-=.005),g+=.07,function(){s.beginPath(),s.save();for(var e=[],t=2;t<=2+p;t+=20/p){var r=g+(2+t)/d,i=Math.sin(r)*f,o=t,a=2*u*(1-v)+(h-u)-d*i;s.lineTo(o,a),e.push([o,a])}var l=e.shift();s.lineTo(2+p,c),s.lineTo(2,c),s.lineTo(l[0],l[1]);var y=s.createLinearGradient(0,0,0,c);y.addColorStop(0,"#ffffff"),y.addColorStop(1,n),s.fillStyle=y,s.fill(),s.restore()}()}o.timer=requestAnimationFrame(t)}()}},e.prototype.updateRadio=function(){var e=this.el.nativeElement.parentNode.offsetWidth,t=e<this.height?e/this.height:1;this.renderer.setStyle(this.el.nativeElement,"transform","scale("+t+")")},e.prototype.installResizeEvent=function(){var e=this;this.resize$=r.fromEvent(window,"resize").pipe(i.debounceTime(200)).subscribe((function(){return e.updateRadio()}))},e.prototype.ngOnInit=function(){var e=this;this.installResizeEvent(),this.ngZone.runOutsideAngular((function(){return setTimeout((function(){return e.renderChart("")}),e.delay)}))},e.prototype.ngOnChanges=function(){var e=this;this.ngZone.runOutsideAngular((function(){return e.renderChart("update")})),this.cdr.detectChanges()},e.prototype.ngOnDestroy=function(){this.timer&&cancelAnimationFrame(this.timer),this.resize$.unsubscribe()},e.decorators=[{type:t.Component,args:[{selector:"g2-water-wave",exportAs:"g2WaterWave",template:'<div [ngStyle]="{\'height.px\': height, \'width.px\': height, \'overflow\': \'hidden\'}">\n  <canvas #container class="g2-water-wave__canvas" width="{{height*2}}" height="{{height*2}}"></canvas>\n</div>\n<div class="g2-water-wave__desc" [ngStyle]="{\'width.px\': height}">\n  <span *ngIf="title" class="g2-water-wave__desc-title">\n    <ng-container *stringTemplateOutlet="title">{{title}}</ng-container>\n  </span>\n  <h4 class="g2-water-wave__desc-percent">{{percent}}%</h4>\n</div>\n',host:{"[class.g2-water-wave]":"true"},preserveWhitespaces:!1,changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:t.NgZone},{type:t.ChangeDetectorRef}]},e.propDecorators={node:[{type:t.ViewChild,args:["container",{static:!0}]}],delay:[{type:t.Input}],title:[{type:t.Input}],color:[{type:t.Input}],height:[{type:t.Input}],percent:[{type:t.Input}]},a([n.InputNumber(),s("design:type",Object)],e.prototype,"delay",void 0),a([n.InputNumber(),s("design:type",Object)],e.prototype,"height",void 0),a([n.InputNumber(),s("design:type",Number)],e.prototype,"percent",void 0),e}();var u=[h],p=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule,n.DelonUtilModule],declarations:c(u),exports:c(u)}]}],e}();e.G2WaterWaveComponent=h,e.G2WaterWaveModule=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=water-wave.umd.min.js.map