/**
 * @license ng-alain(cipchk@qq.com) v2.0.0-beta.5
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@delon/util"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/chart/timeline",["exports","@angular/core","@delon/util","@angular/common"],e):e((t.delon=t.delon||{},t.delon.chart=t.delon.chart||{},t.delon.chart.timeline={}),t.ng.core,t.delon.util,t.ng.common)}(this,function(t,e,i,n){"use strict";var r=function(){function t(t,e){this.cd=t,this.zone=e,this._title="",this.colorMap={y1:"#1890FF",y2:"#2FC25B"},this.mask="HH:mm",this.position="top",this._height=400,this.padding=[60,20,40,40],this._borderWidth=2,this.initFlag=!1}return Object.defineProperty(t.prototype,"title",{set:function(t){t instanceof e.TemplateRef?(this._title=null,this._titleTpl=t):this._title=t,this.cd.detectChanges()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=i.toNumber(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"borderWidth",{set:function(t){this._borderWidth=i.toNumber(t)},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.initFlag=!0,this.runInstall()},t.prototype.runInstall=function(){var t=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return t.install()})})},t.prototype.install=function(){if(this.data&&!(this.data&&this.data.length<1)){this.uninstall(),this.sliderNode.nativeElement.innerHTML="",this.node.nativeElement.innerHTML="";var t=8<this.data.length?(this.data.length-8)/2:0,n=new DataSet({state:{start:this.data[t-1].x,end:this.data[t-1+8].x}}),e=n.createView().source(this.data);e.source(this.data).transform({type:"filter",callback:function(t){var e=new Date(t.x).getTime();return e>=n.state.start&&e<=n.state.end}});var i,r=new G2.Chart({container:this.node.nativeElement,forceFit:!0,height:+this.height,padding:this.padding});r.axis("x",{title:!1}),r.axis("y1",{title:!1}),r.axis("y2",!1),this.data[0]&&this.data[0].y1&&this.data[0].y2&&(i=Math.max(this.data.sort(function(t,e){return e.y1-t.y1})[0].y1,this.data.sort(function(t,e){return e.y2-t.y2})[0].y2)),r.source(e,{x:{type:"timeCat",tickCount:8,mask:this.mask,range:[0,1]},y1:{alias:this.titleMap.y1,max:i,min:0},y2:{alias:this.titleMap.y2,max:i,min:0}}),r.legend({position:this.position,custom:!0,clickable:!1,items:[{value:this.titleMap.y1,fill:this.colorMap.y1},{value:this.titleMap.y2,fill:this.colorMap.y2}]}),r.line().position("x*y1").color(this.colorMap.y1).size(this._borderWidth),r.line().position("x*y2").color(this.colorMap.y2).size(this._borderWidth),r.render();var o=Object.assign([],this.padding);o[0]=0;var a=new Slider({container:this.sliderNode.nativeElement,height:26,padding:o,scales:{x:{type:"time",tickCount:16,mask:this.mask}},backgroundChart:{type:"line"},start:n.state.start,end:n.state.end,xAxis:"x",yAxis:"y1",data:this.data,onChange:function(t){var e=t.startValue,i=t.endValue;n.setState("start",e),n.setState("end",i)}});a.render(),this.chart=r,this.slider=a}},t.prototype.uninstall=function(){this.chart&&this.chart.destroy(),this.slider&&this.slider.destroy()},t.prototype.ngOnChanges=function(){this.initFlag&&this.runInstall()},t.prototype.ngOnDestroy=function(){this.uninstall()},t.decorators=[{type:e.Component,args:[{selector:"g2-timeline",template:'\n  <ng-container *ngIf="_title; else _titleTpl"><h4>{{_title}}</h4></ng-container>\n  <div #container></div>\n  <div #slider></div>',changeDetection:e.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],t.ctorParameters=function(){return[{type:e.ChangeDetectorRef},{type:e.NgZone}]},t.propDecorators={title:[{type:e.Input}],data:[{type:e.Input}],titleMap:[{type:e.Input}],colorMap:[{type:e.Input}],mask:[{type:e.Input}],position:[{type:e.Input}],height:[{type:e.Input}],padding:[{type:e.Input}],borderWidth:[{type:e.Input}],node:[{type:e.ViewChild,args:["container"]}],sliderNode:[{type:e.ViewChild,args:["slider"]}]},t}();function o(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(r)throw r.error}}return a}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}var s=[r],l=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[]}},t.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule,i.DelonUtilModule],declarations:a(s),exports:a(s)}]}],t}();t.G2TimelineComponent=r,t.G2TimelineModule=l,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=timeline.umd.min.js.map