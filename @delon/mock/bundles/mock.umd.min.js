/**
 * @license ng-alain(cipchk@qq.com) v7.0.1
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators"),require("@angular/common/http"),require("@angular/core")):"function"==typeof define&&define.amd?define("@delon/mock",["exports","rxjs","rxjs/operators","@angular/common/http","@angular/core"],e):e((t.delon=t.delon||{},t.delon.mock={}),t.rxjs,t.rxjs.operators,t.ng.common.http,t.ng.core)}(this,function(t,f,h,d,r){"use strict";var g=function n(t,e){this.status=t,this.error=e},y=function c(){this.delay=300,this.force=!1,this.log=!0,this.executeOtherInterceptors=!0},m=function(){function t(t){this.config=t,this.cached=[],this.applyMock(),delete this.config.data}return t.prototype.applyMock=function(){this.cached=[];try{this.realApplyMock()}catch(t){this.outputError(t)}},t.prototype.realApplyMock=function(){var i=this,t=this.config.data;t&&(Object.keys(t).forEach(function(n){var c=t[n];c&&Object.keys(c).forEach(function(t){var e=c[t];if("function"!=typeof e&&"object"!=typeof e&&"string"!=typeof e)throw Error("mock value of ["+n+"-"+t+"] should be function or object or string, but got "+typeof e);var r=i.genRule(t,e);if(-1===["GET","POST","PUT","HEAD","DELETE","PATCH","OPTIONS"].indexOf(r.method))throw Error("method of "+n+"-"+t+" is not valid");var o=i.cached.find(function(t){return t.url===r.url&&t.method===r.method});o?o.callback=r.callback:i.cached.push(r)})}),this.cached.sort(function(t,e){return(e.martcher||"").toString().length-(t.martcher||"").toString().length}))},t.prototype.genRule=function(t,e){var r="GET",o=t;if(-1<t.indexOf(" ")){var n=t.split(" ");r=n[0].toLowerCase(),o=n[1]}var c=null,i=[];if(~o.indexOf(":")){i=o.split("/").filter(function(t){return t.startsWith(":")}).map(function(t){return t.substring(1)});var a=o.split("/").map(function(t){return t.startsWith(":")?"([^/]+)":t}).join("/");c=new RegExp("^"+a,"i")}else/(\([^)]+\))/i.test(o)&&(c=new RegExp(o,"i"));return{url:o,martcher:c,segments:i,callback:e,method:r.toUpperCase()}},t.prototype.outputError=function(t){var e=t.message.split(": ")[0],r=t.stack.split("\n").filter(function(t){return 0!==t.trim().indexOf("at ")}).map(function(t){return t.replace(e+": ","")});throw r.splice(1,0,[""]),console.group(),console.warn("==========Failed to parse mock config.=========="),console.log(r.join("\n")),console.groupEnd(),t},t.prototype.getRule=function(e,r){e=(e||"GET").toUpperCase();var o={},t=this.cached.filter(function(t){return t.method===e&&(t.martcher?t.martcher.test(r):t.url===r)});if(0===t.length)return null;var n=t.find(function(t){return t.url===r})||t[0];n.martcher&&n.martcher.exec(r).slice(1).map(function(t,e){o[n.segments[e]]=t});return{url:r,method:n.method,params:o,callback:n.callback}},t.prototype.clearCache=function(){this.cached=[]},Object.defineProperty(t.prototype,"rules",{get:function(){return this.cached},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.clearCache()},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:y}]},t}(),b=function(){return(b=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},k=function(){function t(t,e){this.next=t,this.interceptor=e}return t.prototype.handle=function(t){return this.interceptor.intercept(t,this.next)},t}(),o=function(){function t(t){this.injector=t}return t.prototype.intercept=function(e,t){var r,o=this.injector.get(m),n=b({delay:300,force:!1,log:!0,executeOtherInterceptors:!0},this.injector.get(y,null)),c=o.getRule(e.method,e.url.split("?")[0]);if(!c&&!n.force)return t.handle(e);switch(typeof c.callback){case"function":var i={original:e,body:e.body,queryString:{},headers:{},params:c.params},a=e.url.split("?");1<a.length&&a[1].split("&").forEach(function(t){var e=t.split("="),r=e[0],o=e[1];Object.keys(i.queryString).includes(r)?(Array.isArray(i.queryString[r])||(i.queryString[r]=[i.queryString[r]]),i.queryString[r].push(o)):i.queryString[r]=o}),e.params.keys().forEach(function(t){return i.queryString[t]=e.params.get(t)}),e.headers.keys().forEach(function(t){return i.headers[t]=e.headers.get(t)});try{r=c.callback.call(this,i)}catch(p){r=new d.HttpErrorResponse({url:e.url,headers:e.headers,status:400,statusText:p.statusText||"Unknown Error",error:p.error}),p instanceof g&&(r.status=p.status)}break;default:r=c.callback}r instanceof d.HttpResponseBase||(r=new d.HttpResponse({status:200,url:e.url,body:r})),n.log&&(console.log("%cðŸ‘½"+e.method+"->"+e.url+"->request","background:#000;color:#bada55",e),console.log("%cðŸ‘½"+e.method+"->"+e.url+"->response","background:#000;color:#bada55",r));var s=r instanceof d.HttpErrorResponse?f.throwError(r):f.of(r);if(n.executeOtherInterceptors){var u=this.injector.get(d.HTTP_INTERCEPTORS,[]),l=u.slice(u.indexOf(this)+1);if(0<l.length)return l.reduceRight(function(t,e){return new k(t,e)},{handle:function(){return s}}).handle(e).pipe(h.delay(n.delay))}return s.pipe(h.delay(n.delay))},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:r.Injector}]},t}(),e=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[m,{provide:y,useValue:t},{provide:d.HTTP_INTERCEPTORS,useClass:o,multi:!0}]}},e.forChild=function(){return{ngModule:e,providers:[{provide:d.HTTP_INTERCEPTORS,useClass:o,multi:!0}]}},e.decorators=[{type:r.NgModule,args:[{}]}],e}();t.MockStatusError=g,t.MockService=m,t.MockInterceptor=o,t.DelonMockConfig=y,t.DelonMockModule=e,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mock.umd.min.js.map