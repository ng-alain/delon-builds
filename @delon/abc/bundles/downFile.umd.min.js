/**
 * @license ng-alain(cipchk@qq.com) v7.3.0
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@delon/theme"),require("file-saver"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/abc/down-file",["exports","@angular/core","@delon/theme","file-saver","@angular/common"],t):t(((e=e||self).delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc["down-file"]={}),e.ng.core,e.delon.theme,e.saveAs,e.ng.common)}(this,function(e,t,r,n,o){"use strict";function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(l){o={error:l}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return s}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e}var l=function(){function e(e,r){this.el=e,this._http=r,this.httpMethod="get",this.success=new t.EventEmitter,this.error=new t.EventEmitter}return e.prototype.getDisposition=function(e){return(e||"").split(";").filter(function(e){return e.includes("=")}).map(function(e){var t,r=e.split("="),n=r[1];return n.startsWith("UTF-8''")&&(n=n.substr("UTF-8''".length)),(t={})[r[0].trim()]=n,t}).reduce(function(e,t){return t},{})},e.prototype._click=function(){var e=this;this.el.nativeElement.disabled=!0,this._http.request(this.httpMethod,this.httpUrl,{params:this.httpData||{},responseType:"blob",observe:"response"}).subscribe(function(t){if(200!==t.status||t.body.size<=0)e.error.emit(t);else{var r=e.getDisposition(t.headers.get("content-disposition")),o=e.fileName||r["filename*"]||r.filename||t.headers.get("filename")||t.headers.get("x-filename");n.saveAs(t.body,decodeURI(o)),e.success.emit(t),e.el.nativeElement.disabled=!1}},function(t){e.error.emit(t),e.el.nativeElement.disabled=!1})},e.decorators=[{type:t.Directive,args:[{selector:"[down-file]",exportAs:"downFile",host:{"(click)":"_click()"}}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:r._HttpClient}]},e.propDecorators={httpData:[{type:t.Input,args:["http-data"]}],httpMethod:[{type:t.Input,args:["http-method"]}],httpUrl:[{type:t.Input,args:["http-url"]}],fileName:[{type:t.Input,args:["file-name"]}],success:[{type:t.Output}],error:[{type:t.Output}]},e}(),a=[l],u=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule,r.AlainThemeModule],declarations:s(a),exports:s(a)}]}],e}();e.DownFileDirective=l,e.DownFileModule=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=downFile.umd.min.js.map