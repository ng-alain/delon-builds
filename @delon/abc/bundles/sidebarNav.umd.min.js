/**
 * @license ng-alain(cipchk@qq.com) v2.0.0-beta.5
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/router"),require("@angular/common"),require("rxjs/operators"),require("@delon/theme"),require("@delon/util"),require("ng-zorro-antd")):"function"==typeof define&&define.amd?define("@delon/abc/sidebar-nav",["exports","@angular/core","@angular/router","@angular/common","rxjs/operators","@delon/theme","@delon/util","ng-zorro-antd"],t):t((e.delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc["sidebar-nav"]={}),e.ng.core,e.ng.router,e.ng.common,e.rxjs.operators,e.delon.theme,e.delon.util,e.ngZorro.antd)}(this,function(e,r,i,t,o,l,a,n){"use strict";var d="sidebar-nav__floating-show",s="sidebar-nav__floating",c=function(){function e(e,t,n,i,o,l,a){this.menuSrv=e,this.settings=t,this.router=n,this.locationStrategy=i,this.render=o,this.cd=l,this.doc=a,this.list=[],this.autoCloseUnderPad=!0,this.select=new r.EventEmitter}return Object.defineProperty(e.prototype,"collapsed",{get:function(){return this.settings.layout.collapsed},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.bodyEl=this.doc.querySelector("body"),this.menuSrv.openedByUrl(this.router.url),this.genFloatingContainer(),this.change$=this.menuSrv.change.subscribe(function(e){t.list=e,t.cd.detectChanges()}),this.installUnderPad()},e.prototype.floatingAreaClickHandle=function(e){e.stopPropagation();var t=e.target;if("A"!==t.nodeName)return!1;var n=t.getAttribute("href");if(n&&n.startsWith("#")&&(n=n.slice(1)),"external"===t.dataset.type)return!0;var i=this.locationStrategy.getBaseHref();return i&&(n=n.slice(i.length)),this.router.navigateByUrl(n),this.onSelect(this.menuSrv.getPathByUrl(n).pop()),this.hideAll(),e.preventDefault(),!1},e.prototype.clearFloatingContainer=function(){this.floatingEl&&(this.floatingEl.removeEventListener("click",this.floatingAreaClickHandle.bind(this)),this.floatingEl.hasOwnProperty("remove")?this.floatingEl.remove():this.floatingEl.parentNode&&this.floatingEl.parentNode.removeChild(this.floatingEl))},e.prototype.genFloatingContainer=function(){this.clearFloatingContainer(),this.floatingEl=this.render.createElement("div"),this.floatingEl.classList.add(s+"-container"),this.floatingEl.addEventListener("click",this.floatingAreaClickHandle.bind(this),!1),this.bodyEl.appendChild(this.floatingEl)},e.prototype.genSubNode=function(e,t){var n="_sidebar-nav-"+t.__id,i=e.nextElementSibling.cloneNode(!0);return i.id=n,i.classList.add(s),i.addEventListener("mouseleave",function(){i.classList.remove(d)},!1),this.floatingEl.appendChild(i),i},e.prototype.hideAll=function(){for(var e=this.floatingEl.querySelectorAll("."+s),t=0;t<e.length;t++)e[t].classList.remove(d)},e.prototype.calPos=function(e,t){var n=e.getBoundingClientRect(),i=Math.max(this.doc.documentElement.scrollTop,this.bodyEl.scrollTop),o=Math.max(this.doc.documentElement.clientHeight,this.bodyEl.clientHeight),l=0;o<n.top+t.clientHeight&&(l=n.top+t.clientHeight-o),t.style.top=n.top+i-l+"px",t.style.left=n.right+5+"px"},e.prototype.showSubMenu=function(e,t){if(!0===this.collapsed){e.preventDefault();var n=e.target;this.genFloatingContainer();var i=this.genSubNode(n,t);this.hideAll(),i.classList.add(d),this.calPos(n,i)}},e.prototype.onSelect=function(e){this.select.emit(e)},e.prototype.toggleOpen=function(n){this.menuSrv.visit(function(e,t){e!==n&&(e._open=!1)});for(var e=n.__parent;e;)e._open=!0,e=e.__parent;n._open=!n._open,this.cd.markForCheck()},e.prototype._click=function(){this.isPad&&this.collapsed&&(this.openAside(!1),this.hideAll())},e.prototype._docClick=function(){this.hideAll()},e.prototype.ngOnDestroy=function(){this.change$.unsubscribe(),this.route$&&this.route$.unsubscribe(),this.clearFloatingContainer()},Object.defineProperty(e.prototype,"isPad",{get:function(){return window.innerWidth<768},enumerable:!0,configurable:!0}),e.prototype.installUnderPad=function(){var t=this;this.autoCloseUnderPad&&(this.route$=this.router.events.pipe(o.filter(function(e){return e instanceof i.NavigationEnd})).subscribe(function(e){return t.underPad()}),this.underPad())},e.prototype.underPad=function(){var e=this;this.isPad&&!this.collapsed&&setTimeout(function(){return e.openAside(!0)})},e.prototype.openAside=function(e){this.settings.setLayout("collapsed",e)},e.decorators=[{type:r.Component,args:[{selector:"sidebar-nav",template:'<ul class="sidebar-nav">\n  <ng-container *ngFor="let group of list">\n    <ng-template [ngIf]="group._hidden !== true">\n      <li class="sidebar-nav__item sidebar-nav__group-title" *ngIf="group.group">\n        <span>{{ group.text }}</span>\n      </li>\n      <ng-container *ngFor="let child1 of group.children">\n        <li *ngIf="child1._hidden !== true" routerLinkActive="sidebar-nav__selected"\n            [routerLinkActiveOptions]="{exact: child1.linkExact}" class="sidebar-nav__item"\n            [class.sidebar-nav__open]="child1._open">\n          \x3c!-- link --\x3e\n          <a *ngIf="child1._type === 1" (click)="onSelect(child1)" [routerLink]="child1.link"\n             [target]="child1.target">\n            <i *ngIf="!collapsed" class="{{ child1.icon }}"></i>\n            <nz-tooltip *ngIf="collapsed" nzPlacement="right" [nzTitle]="child1.text">\n              <span nz-tooltip>\n                <i class="{{ child1.icon }}"></i>\n              </span>\n            </nz-tooltip>\n            <span>{{ child1.text }}</span>\n          </a>\n          \x3c!-- external link --\x3e\n          <a *ngIf="child1._type === 2" href="{{ child1.externalLink }}" target="{{child1.target}}"\n             data-type="external">\n            <i *ngIf="!collapsed" class="{{ child1.icon }}"></i>\n            <nz-tooltip *ngIf="collapsed" nzPlacement="right" [nzTitle]="child1.text">\n              <span nz-tooltip>\n                <i class="{{ child1.icon }}"></i>\n              </span>\n            </nz-tooltip>\n            <span>{{ child1.text }}</span>\n          </a>\n          \x3c!-- has children link --\x3e\n          <a *ngIf="child1._type === 3" class="sidebar-nav__sub-title" (click)="toggleOpen(child1)"\n             (mouseenter)="showSubMenu($event, child1)">\n            <i class="{{ child1.icon }}"></i>\n            <span>{{ child1.text }}</span>\n          </a>\n          \x3c!-- badge --\x3e\n          <div *ngIf="child1.badge" title="{{child1.badge}}" class="badge badge-{{child1.badgeStatus}}"\n               [class.badge-dot]="child1.badgeDot">\n            <em>{{child1.badge}}</em>\n          </div>\n          \x3c!-- Level 2 --\x3e\n          <ul *ngIf="child1._type === 3" class="sidebar-nav sidebar-nav__sub sidebar-nav__depth{{child1._depth}}">\n            <ng-container *ngFor="let child2 of child1.children">\n              <li *ngIf="child2._hidden !== true" routerLinkActive="sidebar-nav__selected"\n                  [routerLinkActiveOptions]="{exact: child2.linkExact}" class="sidebar-nav__item"\n                  [class.sidebar-nav__open]="child2._open">\n                \x3c!-- link --\x3e\n                <a *ngIf="child2._type === 1" (click)="onSelect(child2)" [routerLink]="child2.link"\n                   [target]="child2.target">{{\n                  child2.text }}</a>\n                \x3c!-- external link --\x3e\n                <a *ngIf="child2._type === 2" href="{{ child2.externalLink }}" target="{{ child2.target }}"\n                   data-type="external">{{\n                  child2.text }}</a>\n                \x3c!-- has children link --\x3e\n                <a *ngIf="child2._type === 3" class="sidebar-nav__sub-title" (click)="toggleOpen(child2)">\n                  {{ child2.text }}\n                </a>\n                \x3c!-- badge --\x3e\n                <div *ngIf="child2.badge" title="{{child2.badge}}" class="badge badge-{{child2.badgeStatus}}"\n                     [class.badge-dot]="child2.badgeDot">\n                  <em>{{child2.badge}}</em>\n                </div>\n                \x3c!-- Level 3 --\x3e\n                <ul *ngIf="child2._type === 3" class="sidebar-nav sidebar-nav__sub sidebar-nav__depth{{child2._depth}}">\n                  <ng-container *ngFor="let child3 of child2.children">\n                    <li *ngIf="child3._hidden !== true" routerLinkActive="sidebar-nav__selected"\n                        [routerLinkActiveOptions]="{exact: child3.linkExact}" class="sidebar-nav__item"\n                        [class.sidebar-nav__open]="child3._open">\n                      \x3c!-- link --\x3e\n                      <a *ngIf="child3._type === 1" (click)="onSelect(child3)" [routerLink]="child3.link"\n                         [target]="child3.target">{{\n                        child3.text }}</a>\n                      \x3c!-- external link --\x3e\n                      <a *ngIf="child3._type === 2" href="{{ child3.externalLink }}" target="{{ child3.target }}"\n                         data-type="external">{{\n                        child3.text }}</a>\n                      \x3c!-- badge --\x3e\n                      <div *ngIf="child3.badge" title="{{child3.badge}}" class="badge badge-{{child3.badgeStatus}}"\n                           [class.badge-dot]="child3.badgeDot">\n                        <em>{{child3.badge}}</em>\n                      </div>\n                    </li>\n                  </ng-container>\n                </ul>\n              </li>\n            </ng-container>\n          </ul>\n        </li>\n      </ng-container>\n    </ng-template>\n  </ng-container>\n</ul>\n',changeDetection:r.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],e.ctorParameters=function(){return[{type:l.MenuService},{type:l.SettingsService},{type:i.Router},{type:t.LocationStrategy},{type:r.Renderer2},{type:r.ChangeDetectorRef},{type:undefined,decorators:[{type:r.Inject,args:[t.DOCUMENT]}]}]},e.propDecorators={autoCloseUnderPad:[{type:r.Input}],select:[{type:r.Output}],_click:[{type:r.HostListener,args:["click"]}],_docClick:[{type:r.HostListener,args:["document:click"]}]},function c(e,t,n,i){var o,l=arguments.length,a=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;0<=r;r--)(o=e[r])&&(a=(l<3?o(a):3<l?o(t,n,a):o(t,n))||a);return 3<l&&a&&Object.defineProperty(t,n,a),a}([a.InputBoolean(),function n(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:type",Object)],e.prototype,"autoCloseUnderPad",void 0),e}(),h=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule,i.RouterModule,n.NgZorroAntdModule,a.DelonUtilModule],declarations:[c],exports:[c]}]}],e}();e.SidebarNavComponent=c,e.SidebarNavModule=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sidebarNav.umd.min.js.map