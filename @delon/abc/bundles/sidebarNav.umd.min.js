/**
 * @license ng-alain(cipchk@qq.com) v7.2.0
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/common"),require("@angular/core"),require("@angular/router"),require("rxjs"),require("rxjs/operators"),require("@delon/theme"),require("@delon/util"),require("ng-zorro-antd")):"function"==typeof define&&define.amd?define("@delon/abc/sidebar-nav",["exports","@angular/common","@angular/core","@angular/router","rxjs","rxjs/operators","@delon/theme","@delon/util","ng-zorro-antd"],n):n(((e=e||self).delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc["sidebar-nav"]={}),e.ng.common,e.ng.core,e.ng.router,e.rxjs,e.rxjs.operators,e.delon.theme,e.delon.util,e["ng-zorro-antd"])}(this,function(e,n,t,i,a,l,o,r,s){"use strict";function d(e,n,t,i){var a,l=arguments.length,o=l<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(a=e[r])&&(o=(l<3?a(o):l>3?a(n,t,o):a(n,t))||o);return l>3&&o&&Object.defineProperty(n,t,o),o}function c(e,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,n)}var p="sidebar-nav__floating-show",h=function(){function e(e,n,i,l,o,r,s,d){this.menuSrv=e,this.settings=n,this.router=i,this.render=l,this.cdr=o,this.ngZone=r,this.doc=s,this.win=d,this.unsubscribe$=new a.Subject,this.list=[],this.disabledAcl=!1,this.autoCloseUnderPad=!0,this.recursivePath=!0,this.openStrictly=!1,this.select=new t.EventEmitter}return Object.defineProperty(e.prototype,"collapsed",{get:function(){return this.settings.layout.collapsed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_d",{get:function(){return this.menuSrv.menus},enumerable:!0,configurable:!0}),e.prototype.floatingAreaClickHandle=function(e){e.stopPropagation();var n=e.target;if("A"!==n.nodeName)return!1;var t,i=+n.dataset.id;return this.menuSrv.visit(this._d,function(e){t||e.__id!==i||(t=e)}),this.to(t),this.hideAll(),e.preventDefault(),!1},e.prototype.clearFloatingContainer=function(){this.floatingEl&&(this.floatingEl.removeEventListener("click",this.floatingAreaClickHandle.bind(this)),this.floatingEl.hasOwnProperty("remove")?this.floatingEl.remove():this.floatingEl.parentNode&&this.floatingEl.parentNode.removeChild(this.floatingEl))},e.prototype.genFloatingContainer=function(){this.clearFloatingContainer(),this.floatingEl=this.render.createElement("div"),this.floatingEl.classList.add("sidebar-nav__floating-container"),this.floatingEl.addEventListener("click",this.floatingAreaClickHandle.bind(this),!1),this.bodyEl.appendChild(this.floatingEl)},e.prototype.genSubNode=function(e,n){var t="_sidebar-nav-"+n.__id,i=e.nextElementSibling.cloneNode(!0);return i.id=t,i.classList.add("sidebar-nav__floating"),i.addEventListener("mouseleave",function(){i.classList.remove(p)},!1),this.floatingEl.appendChild(i),i},e.prototype.hideAll=function(){for(var e=this.floatingEl.querySelectorAll(".sidebar-nav__floating"),n=0;n<e.length;n++)e[n].classList.remove(p)},e.prototype.calPos=function(e,n){var t=e.getBoundingClientRect(),i=Math.max(this.doc.documentElement.scrollTop,this.bodyEl.scrollTop),a=Math.max(this.doc.documentElement.clientHeight,this.bodyEl.clientHeight),l=0;a<t.top+n.clientHeight&&(l=t.top+n.clientHeight-a),n.style.top=t.top+i-l+"px",n.style.left=t.right+5+"px"},e.prototype.showSubMenu=function(e,n){var t=this;!0===this.collapsed&&this.ngZone.runOutsideAngular(function(){e.preventDefault();var i=e.target;t.genFloatingContainer();var a=t.genSubNode(i,n);t.hideAll(),a.classList.add(p),t.calPos(i,a)})},e.prototype.to=function(e){var n=this;if(this.select.emit(e),!e.disabled)return e.externalLink?("_blank"===e.target?this.win.open(e.externalLink):this.win.location.href=e.externalLink,!1):void this.ngZone.run(function(){return n.router.navigateByUrl(e.link)})},e.prototype.toggleOpen=function(e){if(!this.openStrictly){this.menuSrv.visit(this._d,function(n,t){n!==e&&(n._open=!1)});for(var n=e.__parent;n;)n._open=!0,n=n.__parent}e._open=!e._open,this.cdr.markForCheck()},e.prototype._click=function(){this.isPad&&this.collapsed&&(this.openAside(!1),this.hideAll())},e.prototype._docClick=function(){this.hideAll()},e.prototype.ngOnInit=function(){var e=this,n=this,t=n.doc,a=n.router,o=n.unsubscribe$,r=n.menuSrv,s=n.cdr;this.bodyEl=t.querySelector("body"),r.openedByUrl(a.url,this.recursivePath),this.ngZone.runOutsideAngular(function(){return e.genFloatingContainer()}),r.change.pipe(l.takeUntil(o)).subscribe(function(n){r.visit(n,function(n){n._aclResult||(e.disabledAcl?n.disabled=!0:n._hidden=!0),e.openStrictly&&(n._open=null!=n.open&&n.open)}),e.list=r.menus,s.detectChanges()}),a.events.pipe(l.takeUntil(o)).subscribe(function(n){n instanceof i.NavigationEnd&&(e.menuSrv.openedByUrl(n.urlAfterRedirects,e.recursivePath),e.underPad(),e.cdr.detectChanges())}),this.underPad()},e.prototype.ngOnDestroy=function(){var e=this.unsubscribe$;e.next(),e.complete(),this.clearFloatingContainer()},Object.defineProperty(e.prototype,"isPad",{get:function(){return window.innerWidth<768},enumerable:!0,configurable:!0}),e.prototype.underPad=function(){var e=this;this.autoCloseUnderPad&&this.isPad&&!this.collapsed&&setTimeout(function(){return e.openAside(!0)})},e.prototype.openAside=function(e){this.settings.setLayout("collapsed",e)},e.decorators=[{type:t.Component,args:[{selector:"sidebar-nav",template:'<ng-template #icon\n             let-i>\n  <ng-container *ngIf="i"\n                [ngSwitch]="i.type">\n    <i *ngSwitchCase="\'icon\'"\n       class="sidebar-nav__item-icon"\n       nz-icon\n       [type]="i.value"\n       [theme]="i.theme"\n       [spin]="i.spin"\n       [twoToneColor]="i.twoToneColor"\n       [iconfont]="i.iconfont"></i>\n    <img *ngSwitchCase="\'img\'"\n         src="{{ i.value }}"\n         class="sidebar-nav__item-icon sidebar-nav__item-img">\n    <i *ngSwitchDefault\n       class="sidebar-nav__item-icon {{ i.value }}"></i>\n  </ng-container>\n</ng-template>\n<ul class="sidebar-nav">\n  <ng-container *ngFor="let group of list">\n    <ng-container *ngIf="group._hidden !== true">\n      <li class="sidebar-nav__item sidebar-nav__group-title"\n          *ngIf="group.group">\n        <span>{{ group.text }}</span>\n      </li>\n      <ng-container *ngFor="let child1 of group.children">\n        <li *ngIf="child1._hidden !== true"\n            class="sidebar-nav__item"\n            [class.sidebar-nav__selected]="child1._selected"\n            [class.sidebar-nav__open]="child1._open">\n          \x3c!-- link --\x3e\n          <a *ngIf="child1._type <= 2"\n             (click)="to(child1)"\n             [attr.data-id]="child1.__id"\n             class="sidebar-nav__item-link"\n             [ngClass]="{\'sidebar-nav__item-disabled\': child1.disabled}">\n            <ng-container *ngIf="!collapsed">\n              <ng-template [ngTemplateOutlet]="icon"\n                           [ngTemplateOutletContext]="{$implicit: child1.icon}"></ng-template>\n            </ng-container>\n            <nz-tooltip *ngIf="collapsed"\n                        nzPlacement="right"\n                        [nzTitle]="child1.text">\n              <span nz-tooltip>\n                <ng-template [ngTemplateOutlet]="icon"\n                             [ngTemplateOutletContext]="{$implicit: child1.icon}"></ng-template>\n              </span>\n            </nz-tooltip>\n            <span class="sidebar-nav__item-text">{{ child1.text }}</span>\n          </a>\n          \x3c!-- has children link --\x3e\n          <a *ngIf="child1._type === 3"\n             (click)="toggleOpen(child1)"\n             (mouseenter)="showSubMenu($event, child1)"\n             class="sidebar-nav__item-link">\n            <ng-template [ngTemplateOutlet]="icon"\n                         [ngTemplateOutletContext]="{$implicit: child1.icon}"></ng-template>\n            <span class="sidebar-nav__item-text">{{ child1.text }}</span>\n            <i class="sidebar-nav__sub-arrow"></i>\n          </a>\n          \x3c!-- badge --\x3e\n          <div *ngIf="child1.badge"\n               title="{{child1.badge}}"\n               class="badge badge-{{child1.badgeStatus}}"\n               [class.badge-dot]="child1.badgeDot">\n            <em>{{child1.badge}}</em>\n          </div>\n          \x3c!-- Level 2 --\x3e\n          <ul *ngIf="child1._type === 3"\n              class="sidebar-nav sidebar-nav__sub sidebar-nav__depth{{child1._depth}}">\n            <ng-container *ngFor="let child2 of child1.children">\n              <li *ngIf="child2._hidden !== true"\n                  class="sidebar-nav__item"\n                  [class.sidebar-nav__selected]="child2._selected"\n                  [class.sidebar-nav__open]="child2._open">\n                \x3c!-- link --\x3e\n                <a *ngIf="child2._type <= 2"\n                   (click)="to(child2)"\n                   [attr.data-id]="child2.__id"\n                   class="sidebar-nav__item-link"\n                   [ngClass]="{\'sidebar-nav__item-disabled\': child2.disabled}">{{\n                  child2.text }}</a>\n                \x3c!-- has children link --\x3e\n                <a *ngIf="child2._type === 3"\n                   (click)="toggleOpen(child2)"\n                   class="sidebar-nav__item-link">\n                  {{ child2.text }}\n                  <i class="sidebar-nav__sub-arrow"></i>\n                </a>\n                \x3c!-- badge --\x3e\n                <div *ngIf="child2.badge"\n                     title="{{child2.badge}}"\n                     class="badge badge-{{child2.badgeStatus}}"\n                     [class.badge-dot]="child2.badgeDot">\n                  <em>{{child2.badge}}</em>\n                </div>\n                \x3c!-- Level 3 --\x3e\n                <ul *ngIf="child2._type === 3"\n                    class="sidebar-nav sidebar-nav__sub sidebar-nav__depth{{child2._depth}}">\n                  <ng-container *ngFor="let child3 of child2.children">\n                    <li *ngIf="child3._hidden !== true"\n                        class="sidebar-nav__item"\n                        [class.sidebar-nav__selected]="child3._selected"\n                        [class.sidebar-nav__open]="child3._open">\n                      \x3c!-- link --\x3e\n                      <a *ngIf="child3._type <= 2"\n                         (click)="to(child3)"\n                         [attr.data-id]="child3.__id"\n                         class="sidebar-nav__item-link"\n                         [ngClass]="{\'sidebar-nav__item-disabled\': child3.disabled}">{{ child3.text }}</a>\n                      \x3c!-- external link --\x3e\n                      <a *ngIf="child3._type === 2"\n                         href="{{ child3.externalLink }}"\n                         target="{{ child3.target }}"\n                         data-type="external"\n                         class="sidebar-nav__item-link">{{ child3.text }}</a>\n                      \x3c!-- badge --\x3e\n                      <div *ngIf="child3.badge"\n                           title="{{child3.badge}}"\n                           class="badge badge-{{child3.badgeStatus}}"\n                           [class.badge-dot]="child3.badgeDot">\n                        <em>{{child3.badge}}</em>\n                      </div>\n                    </li>\n                  </ng-container>\n                </ul>\n              </li>\n            </ng-container>\n          </ul>\n        </li>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n</ul>\n',host:{"(click)":"_click()","(document:click)":"_docClick()"},changeDetection:t.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:o.MenuService},{type:o.SettingsService},{type:i.Router},{type:t.Renderer2},{type:t.ChangeDetectorRef},{type:t.NgZone},{type:undefined,decorators:[{type:t.Inject,args:[n.DOCUMENT]}]},{type:Window,decorators:[{type:t.Inject,args:[o.WINDOW]}]}]},e.propDecorators={disabledAcl:[{type:t.Input}],autoCloseUnderPad:[{type:t.Input}],recursivePath:[{type:t.Input}],openStrictly:[{type:t.Input}],select:[{type:t.Output}]},d([r.InputBoolean(),c("design:type",Object)],e.prototype,"disabledAcl",void 0),d([r.InputBoolean(),c("design:type",Object)],e.prototype,"autoCloseUnderPad",void 0),d([r.InputBoolean(),c("design:type",Object)],e.prototype,"recursivePath",void 0),d([r.InputBoolean(),c("design:type",Object)],e.prototype,"openStrictly",void 0),e}(),u=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,i.RouterModule,s.NgZorroAntdModule,r.DelonUtilModule],declarations:[h],exports:[h]}]}],e}();e.SidebarNavComponent=h,e.SidebarNavModule=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sidebarNav.umd.min.js.map