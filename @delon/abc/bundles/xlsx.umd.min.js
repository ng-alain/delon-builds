/**
 * @license ng-alain(cipchk@qq.com) v8.9.0
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("@delon/util"),require("file-saver"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/abc/xlsx",["exports","@angular/core","@angular/common/http","@delon/util","file-saver","@angular/common"],t):t(((e=e||self).delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.xlsx={}),e.ng.core,e.ng.common.http,e.delon.util,e.saveAs,e.ng.common)}(this,(function(e,t,r,n,o,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}var l=function(){function e(){this.url="//cdn.bootcss.com/xlsx/0.12.13/xlsx.full.min.js",this.modules=[]}return e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var u=function(){function e(e,t,r){this.cog=e,this.http=t,this.lazy=r}return e.prototype.init=function(){return"undefined"!=typeof XLSX?Promise.resolve([]):this.lazy.load([this.cog.url].concat(this.cog.modules))},e.prototype.read=function(e){var t={};return e.SheetNames.forEach((function(r){var n=e.Sheets[r];t[r]=XLSX.utils.sheet_to_json(n,{header:1})})),t},e.prototype.import=function(e,t){var r=this;return void 0===t&&(t="readAsBinaryString"),new Promise((function(n,o){r.init().then((function(){if("string"!=typeof e){var a=new FileReader;a.onload=function(e){var t=XLSX.read(e.target.result,{type:"binary"});n(r.read(t))},a[t](e)}else r.http.request("GET",e,{responseType:"arraybuffer"}).subscribe((function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"});n(r.read(t))}),(function(e){o(e)}))})).catch((function(){return o("Unable to load xlsx.js")}))}))},e.prototype.export=function(e){return this.init().then((function(){var t=XLSX.utils.book_new();Array.isArray(e.sheets)?e.sheets.forEach((function(e,r){var n=XLSX.utils.aoa_to_sheet(e.data);XLSX.utils.book_append_sheet(t,n,e.name||"Sheet"+(r+1))})):(t.SheetNames=Object.keys(e.sheets),t.Sheets=e.sheets),e.callback&&e.callback(t);var r=XLSX.write(t,i({bookType:"xlsx",bookSST:!1,type:"array"},e.opts));o.saveAs(new Blob([r],{type:"application/octet-stream"}),e.filename||"export.xlsx")}))},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:l},{type:r.HttpClient},{type:n.LazyService}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(l),t.ɵɵinject(r.HttpClient),t.ɵɵinject(n.LazyService))},token:e,providedIn:"root"}),e}();var f=function(){function e(e){this.srv=e}return e.prototype._click=function(){this.srv.export(this.data)},e.decorators=[{type:t.Directive,args:[{selector:"[xlsx]",exportAs:"xlsx",host:{"(click)":"_click()"}}]}],e.ctorParameters=function(){return[{type:u}]},e.propDecorators={data:[{type:t.Input,args:["xlsx"]}]},e}();var p=[f],d=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[a.CommonModule,n.DelonUtilModule],declarations:s(p),exports:s(p)}]}],e}();e.XlsxConfig=l,e.XlsxDirective=f,e.XlsxModule=d,e.XlsxService=u,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=xlsx.umd.min.js.map