/**
 * @license ng-alain(cipchk@qq.com) v2.0.0-beta.5
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("file-saver"),require("@delon/util"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/abc/xlsx",["exports","@angular/core","@angular/common/http","file-saver","@delon/util","@angular/common"],t):t((e.delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.xlsx={}),e.ng.core,e.ng.common.http,e.saveAs,e.delon.util,e.ng.common)}(this,function(e,t,r,n,o,i){"use strict";var a=function d(){this.url="//cdn.bootcss.com/xlsx/0.12.13/xlsx.full.min.js",this.modules=[]},s=function(){function e(e,t,r){this.cog=e,this.http=t,this.lazy=r}return e.prototype.init=function(){return this.lazy.load([this.cog.url].concat(this.cog.modules))},e.prototype.read=function(r){var o={};return r.SheetNames.forEach(function(e){var t=r.Sheets[e];o[e]=XLSX.utils.sheet_to_json(t,{header:1})}),o},e.prototype["import"]=function(o,n){var i=this;return void 0===n&&(n="readAsBinaryString"),new Promise(function(r,t){i.init().then(function(){if("string"!=typeof o){var e=new FileReader;e.onload=function(e){var t=XLSX.read(e.target.result,{type:"binary"});r(i.read(t))},e[n](o)}else i.http.request("GET",o,{responseType:"arraybuffer"}).subscribe(function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"});r(i.read(t))},function(e){t(e)})})})},e.prototype["export"]=function(t){return this.init().then(function(){var o=XLSX.utils.book_new();Array.isArray(t.sheets)?t.sheets.forEach(function(e,t){var r=XLSX.utils.aoa_to_sheet(e.data);XLSX.utils.book_append_sheet(o,r,e.name||"Sheet"+(t+1))}):(o.SheetNames=Object.keys(t.sheets),o.Sheets=t.sheets),t.callback&&t.callback(o);var e=XLSX.write(o,Object.assign({bookType:"xlsx",bookSST:!1,type:"array"},t.opts));n.saveAs(new Blob([e],{type:"application/octet-stream"}),t.filename||"export.xlsx")})},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:a},{type:r.HttpClient},{type:o.LazyService}]},e}(),c=function(){function e(e){this.srv=e}return e.prototype._click=function(){this.srv["export"](this.data)},e.decorators=[{type:t.Directive,args:[{selector:"[xlsx]"}]}],e.ctorParameters=function(){return[{type:s}]},e.propDecorators={data:[{type:t.Input,args:["xlsx"]}],_click:[{type:t.HostListener,args:["click"]}]},e}();function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(n)throw n.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var p=[c],f=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[s,a]}},e.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule,o.DelonUtilModule],declarations:u(p),exports:u(p)}]}],e}();e.XlsxConfig=a,e.XlsxService=s,e.XlsxDirective=c,e.XlsxModule=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=xlsx.umd.min.js.map