/**
 * @license ng-alain(cipchk@qq.com) v10.1.3
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/router"),require("@delon/theme"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/platform"),require("@delon/util"),require("ng-zorro-antd/button"),require("ng-zorro-antd/core/no-animation"),require("ng-zorro-antd/core/outlet"),require("ng-zorro-antd/popover")):"function"==typeof define&&define.amd?define("@delon/abc/onboarding",["exports","@angular/common","@angular/core","@angular/router","@delon/theme","rxjs","rxjs/operators","@angular/cdk/platform","@delon/util","ng-zorro-antd/button","ng-zorro-antd/core/no-animation","ng-zorro-antd/core/outlet","ng-zorro-antd/popover"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).delon=t.delon||{},t.delon.abc=t.delon.abc||{},t.delon.abc.onboarding={}),t.ng.common,t.ng.core,t.ng.router,t.delon.theme,t.rxjs,t.rxjs.operators,t.ng.cdk.platform,t.delon.util,t["ng-zorro-antd/button"],t["ng-zorro-antd/core/no-animation"],t["ng-zorro-antd/core/outlet"],t["ng-zorro-antd/popover"])}(this,(function(t,e,n,o,i,r,a,s,c,l,p,u,h){"use strict";var d=function(){function t(t,e,o,i){this.el=t,this.doc=e,this.platform=o,this.cdr=i,this.active=0,this.max=0,this.op=new n.EventEmitter,this.running=!1}return Object.defineProperty(t.prototype,"first",{get:function(){return 0===this.active},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){return this.active===this.max-1},enumerable:!1,configurable:!0}),t.prototype._getDoc=function(){return this.doc},t.prototype._getWin=function(){return this._getDoc().defaultView||window},t.prototype.getLightData=function(){var t=this._getDoc(),e=this._getWin(),n=t.querySelector(this.item.selectors);if(!n)return null;var o=e.pageYOffset||t.documentElement.scrollTop||t.body.scrollTop,i=e.pageXOffset||t.documentElement.scrollLeft||t.body.scrollLeft,r=n.getBoundingClientRect(),a=r.top+o,s=r.left+i,c=a>8&&s>8,l=c?8:0,p=c?16:0;return{top:a-l,left:s-l,width:r.width+p,height:r.height+p,el:n,clientWidth:t.body.clientWidth,clientHeight:t.body.clientHeight}},t.prototype.scroll=function(t){this.prevSelectorEl=t.el;var e=t.top-(t.clientHeight-t.height)/2;this._getWin().scrollTo({top:e}),this.updatePrevElStatus(!0)},t.prototype.updateRunning=function(t){this.running=t,this.cdr.detectChanges(),t||this.updatePosition()},t.prototype.updatePosition=function(){if(this.platform.isBrowser){var t=this.getLightData();if(null!=t){var e=this.el.nativeElement.querySelector(".onboarding__light").style;e.top=t.top+"px",e.left=t.left+"px",e.width=t.width+"px",e.height=t.height+"px",this.updatePrevElStatus(!1),this.scroll(t)}else console.warn("Did not matches selectors ["+this.item.selectors+"]")}},t.prototype.updatePrevElStatus=function(t){this.prevSelectorEl&&this.prevSelectorEl.classList[t?"add":"remove"]("onboarding__light-el")},t.prototype.to=function(t){this.op.emit(t)},t.prototype.handleMask=function(){!0===this.config.maskClosable&&this.to("done")},t.prototype.ngOnDestroy=function(){clearTimeout(this.time),this.updatePrevElStatus(!1)},t}();d.decorators=[{type:n.Component,args:[{selector:"onboarding",template:'<div *ngIf="!running && config.mask" class="onboarding__mask" (click)="handleMask()"></div>\n<div\n  *ngIf="item"\n  class="onboarding__light"\n  [class.onboarding__light-hide]="running"\n  [attr.style]="item.lightStyle"\n  nz-popover\n  [nzPopoverTitle]="item.title"\n  [nzPopoverContent]="content"\n  [nzPopoverVisible]="!running"\n  [nzPopoverTrigger]="null"\n  [nzPopoverPlacement]="item.position"\n  [nzPopoverOverlayClassName]="item.className"\n  [nzPopoverOverlayStyle]="{ \'max-width.px\': item.width }"\n  [nzNoAnimation]="true"\n></div>\n<ng-template #content>\n  <ng-container *nzStringTemplateOutlet="item.content">\n    <div [innerHTML]="item.content"></div>\n  </ng-container>\n  <div class="flex-center-between onboarding__footer">\n    <span class="onboarding__total">\n      <ng-container *ngIf="config.showTotal">{{ active + 1 }}/{{ max }}</ng-container>\n    </span>\n    <div class="onboarding__btns">\n      <a *ngIf="!last && item.skip !== null" nz-button nzType="link" (click)="to(\'skip\')" nzSize="small" data-btnType="skip">\n        <ng-container *nzStringTemplateOutlet="item.skip">{{ item.skip }}</ng-container>\n      </a>\n      <a *ngIf="!first && item.prev !== null" nz-button (click)="to(\'prev\')" nzSize="small" data-btnType="prev">\n        <ng-container *nzStringTemplateOutlet="item.prev">{{ item.prev }}</ng-container>\n      </a>\n      <a *ngIf="!last && item.next !== null" nz-button (click)="to(\'next\')" nzType="primary" nzSize="small" data-btnType="next">\n        <ng-container *nzStringTemplateOutlet="item.next">{{ item.next }}</ng-container>\n      </a>\n      <a *ngIf="last && item.done !== null" nz-button (click)="to(\'done\')" nzType="primary" nzSize="small" data-btnType="done">\n        <ng-container *nzStringTemplateOutlet="item.done">{{ item.done }}</ng-container>\n      </a>\n    </div>\n  </div>\n</ng-template>\n',host:{"[class.onboarding]":"true","[attr.data-onboarding-active]":"active"},preserveWhitespaces:!1,changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None}]}],d.ctorParameters=function(){return[{type:n.ElementRef},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[e.DOCUMENT]}]},{type:s.Platform},{type:n.ChangeDetectorRef}]};var g=function(){function t(t,e,n,o,i,r){this.i18n=t,this.appRef=e,this.resolver=n,this.router=o,this.injector=i,this.doc=r,this.active=0,this.running$=null,this._running=!1,this.type=null}return t.prototype._getDoc=function(){return this.doc},Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),t.prototype.attach=function(){var t=this,e=this.compRef=this.resolver.resolveComponentFactory(d).create(this.injector);this.appRef.attachView(e.hostView);var n=e.hostView.rootNodes[0],o=this._getDoc(),i=o.querySelector(".cdk-overlay-container");i?o.body.insertBefore(n,i):o.body.appendChild(n),this.op$=this.compRef.instance.op.subscribe((function(e){switch(e){case"next":t.next();break;case"prev":t.prev();break;default:t.done()}}))},t.prototype.cancelRunning=function(){return this.running$&&(this.running$.unsubscribe(),this.running$=null),this},t.prototype.updateRunning=function(t){return this._running=t,this.compRef.instance.updateRunning(t),this},t.prototype.destroy=function(){this.cancelRunning(),this.compRef&&(this.appRef.detachView(this.compRef.hostView),this.compRef.destroy(),this.op$.unsubscribe())},t.prototype.showItem=function(t){var e=this;void 0===t&&(t=!1);var n=this.config.items,o=Object.assign(Object.assign({position:"bottomLeft",before:r.of(!0),after:r.of(!0)},this.i18n.getData("onboarding")),n[this.active]);Object.assign(this.compRef.instance,{item:o,config:this.config,active:this.active,max:n.length});var i=[a.switchMap((function(){return o.url?e.router.navigateByUrl(o.url):r.of(!0)})),a.switchMap((function(){var t="prev"===e.type?o.after:o.before;return"number"==typeof t?r.of(!0).pipe(a.delay(t)):t}))];t||i.push(a.delay(1)),this.updateRunning(!0),this.running$=r.of(!0).pipe(r.pipe.apply(this,i)).subscribe((function(){return e.cancelRunning().updateRunning(!1)}),(function(){return e.done()}))},t.prototype.start=function(t){this.running||(this.destroy(),this.config=Object.assign({items:[],mask:!0,maskClosable:!0,showTotal:!1},t),this.active=0,this.type=null,this.attach(),this.showItem(!0))},t.prototype.next=function(){this._running||this.active+1>=this.config.items.length?this.done():(this.type="next",++this.active,this.showItem())},t.prototype.prev=function(){this._running||this.active-1<0||(this.type="prev",--this.active,this.showItem())},t.prototype.done=function(){this.type="done",this.destroy()},t.prototype.ngOnDestroy=function(){this.destroy()},t}();g.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],g.ctorParameters=function(){return[{type:i.DelonLocaleService},{type:n.ApplicationRef},{type:n.ComponentFactoryResolver},{type:o.Router},{type:n.Injector},{type:void 0,decorators:[{type:n.Inject,args:[e.DOCUMENT]}]}]},g.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new g(n.ɵɵinject(i.DelonLocaleService),n.ɵɵinject(n.ApplicationRef),n.ɵɵinject(n.ComponentFactoryResolver),n.ɵɵinject(o.Router),n.ɵɵinject(n.INJECTOR),n.ɵɵinject(e.DOCUMENT))},token:g,providedIn:"root"});var f=[d],m=function(){};m.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule,i.DelonLocaleModule,c.DelonUtilModule,h.NzPopoverModule,u.NzOutletModule,l.NzButtonModule,p.NzNoAnimationModule],declarations:f,entryComponents:f,exports:f}]}],t.OnboardingComponent=d,t.OnboardingModule=m,t.OnboardingService=g,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=onboarding.umd.min.js.map