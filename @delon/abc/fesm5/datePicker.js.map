{"version":3,"file":"datePicker.js","sources":["ng://@delon/abc/date-picker/date-picker.config.ts","ng://@delon/abc/date-picker/range.component.ts","ng://@delon/abc/date-picker/date-picker.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { getTimeDistance } from '@delon/util';\nimport { NzSafeAny } from 'ng-zorro-antd/core/types';\nimport { DisabledTimeFn, PanelMode, PresetRanges, SupportTimeOptions } from 'ng-zorro-antd/date-picker/standard-types';\nimport { NzDatePickerI18nInterface } from 'ng-zorro-antd/i18n';\n\nexport class DateRangePickerConfig {\n  nzFormat?: string = 'yyyy-MM-dd';\n  nzClassName?: string;\n  nzSize?: string;\n  nzStyle?: string;\n  nzAllowClear?: boolean = true;\n  nzAutoFocus?: boolean = false;\n  nzDisabled?: boolean = false;\n  nzDisabledDate?: (d: Date) => boolean;\n  nzDisabledTime?: DisabledTimeFn;\n  nzLocale?: NzDatePickerI18nInterface;\n  nzPopupStyle?: object = { position: 'relative' };\n  nzDropdownClassName?: string;\n  nzRenderExtraFooter?: string;\n  nzPlaceHolder?: string | string[];\n  nzShowTime?: SupportTimeOptions | boolean;\n  nzShowToday?: boolean = true;\n  nzMode?: PanelMode | PanelMode[];\n  nzRanges?: PresetRanges;\n  shortcuts?: DateRangePickerShortcut = {\n    enabled: false,\n    closed: true,\n    list: [\n      {\n        text: '今天',\n        fn: () => getTimeDistance('today'),\n      },\n      {\n        text: '昨天',\n        fn: () => getTimeDistance('yesterday'),\n      },\n      {\n        text: '近3天',\n        fn: () => getTimeDistance(-2),\n      },\n      {\n        text: '近7天',\n        fn: () => getTimeDistance(-6),\n      },\n      {\n        text: '本周',\n        fn: () => getTimeDistance('week'),\n      },\n      {\n        text: '本月',\n        fn: () => getTimeDistance('month'),\n      },\n      {\n        text: '全年',\n        fn: () => getTimeDistance('year'),\n      },\n    ],\n  };\n}\n\nexport interface DateRangePickerShortcut {\n  /** Whether to enable, default: `false` */\n  enabled?: boolean;\n  /** Whether to close the panel after clicking, default: `true` */\n  closed?: boolean;\n  /**\n   * Shortcut list, default: `今天`, `昨天`, `近3天`, `近7天`, `本周`, `本月`, `全年`\n   */\n  list?: DateRangePickerShortcutItem[];\n}\n\nexport interface DateRangePickerShortcutItem {\n  [key: string]: NzSafeAny;\n\n  text: string;\n  fn: (value: [Date, Date]) => [Date, Date];\n}\n\n@Injectable({ providedIn: 'root' })\nexport class DatePickerConfig {\n  range?: DateRangePickerConfig;\n}\n","import { Component, EventEmitter, forwardRef, Input, Output, TemplateRef, ViewChild } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { deepMergeKey, fixEndTimeOfRange, InputBoolean } from '@delon/util';\nimport { FunctionProp, NzSafeAny } from 'ng-zorro-antd/core/types';\nimport { NzRangePickerComponent } from 'ng-zorro-antd/date-picker';\nimport { DatePickerConfig, DateRangePickerConfig, DateRangePickerShortcut, DateRangePickerShortcutItem } from './date-picker.config';\n\n@Component({\n  selector: 'range-picker',\n  exportAs: 'rangePicker',\n  templateUrl: './range.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => RangePickerComponent),\n    },\n  ],\n})\nexport class RangePickerComponent implements ControlValueAccessor {\n  private onChangeFn: (val: Date) => void;\n  private _shortcut: DateRangePickerShortcut;\n  private _cog: DateRangePickerConfig;\n  @ViewChild('comp', { static: false }) private comp: NzRangePickerComponent;\n  value: Date[] = [];\n\n  @Input() ngModelEnd: Date;\n  @Input()\n  set shortcut(val: DateRangePickerShortcut | null) {\n    const item = deepMergeKey({}, true, this._cog.shortcuts, val == null ? {} : val) as DateRangePickerShortcut;\n    if (typeof val === 'boolean') {\n      item.enabled = val;\n    }\n    (item.list || []).forEach(i => {\n      i._text = this.dom.bypassSecurityTrustHtml(i.text);\n    });\n    this._shortcut = item;\n  }\n  get shortcut() {\n    return this._shortcut;\n  }\n  @Output() readonly ngModelEndChange = new EventEmitter<Date>();\n\n  // #region Native properties\n\n  @Input() nzAllowClear = true;\n  @Input() nzAutoFocus = false;\n  @Input() nzClassName: string;\n  @Input() nzDisabled: boolean;\n  @Input() nzSize: string;\n  @Input() nzStyle: string;\n  @Input() nzDisabledDate: (d: Date) => boolean;\n  @Input() nzLocale: object;\n  @Input() nzPopupStyle: object;\n  @Input() nzDropdownClassName: string;\n  @Input() nzPlaceHolder: string | string[];\n  @Output() readonly nzOnOpenChange = new EventEmitter<boolean>();\n\n  // range\n  @Input() nzDateRender: any;\n  @Input() nzFormat: any;\n  @Input() nzDisabledTime: any;\n  @Input() nzRenderExtraFooter: FunctionProp<TemplateRef<void> | string>;\n  @Input() nzShowTime: any;\n  @Input() @InputBoolean() nzShowToday: boolean = true;\n  @Input() nzMode: any;\n  @Input() nzRanges: any;\n  @Output() readonly nzOnPanelChange = new EventEmitter<any>();\n  @Output() readonly nzOnOk = new EventEmitter<any>();\n\n  // #endregion\n\n  constructor(cog: DatePickerConfig, private dom: DomSanitizer) {\n    this._cog = deepMergeKey(new DateRangePickerConfig(), true, cog && cog.range);\n    Object.assign(this, this._cog);\n  }\n\n  _nzOnOpenChange(e: any) {\n    this.nzOnOpenChange.emit(e);\n  }\n\n  _nzOnPanelChange(e: any) {\n    this.nzOnPanelChange.emit(e);\n  }\n\n  _nzOnOk(e: any) {\n    this.nzOnOk.emit(e);\n  }\n\n  valueChange(e: [Date, Date]) {\n    e = fixEndTimeOfRange(e);\n    this.onChangeFn(e[0]);\n    this.ngModelEnd = e[1];\n    this.ngModelEndChange.emit(e[1]);\n  }\n\n  writeValue(value: Date): void {\n    this.value = value && this.ngModelEnd ? [value, this.ngModelEnd] : [];\n  }\n\n  registerOnChange(fn: (val: Date) => void): void {\n    this.onChangeFn = fn;\n  }\n\n  registerOnTouched(_fn: () => void): void {\n    // this.onTouchedFn = fn;\n  }\n\n  setDisabledState(disabled: boolean): void {\n    this.nzDisabled = disabled;\n  }\n\n  clickShortcut(item: DateRangePickerShortcutItem) {\n    this.value = item.fn(this.value as any);\n    this.valueChange(this.value as [Date, Date]);\n    if (this._shortcut.closed) {\n      // tslint:disable-next-line:no-string-literal\n      (this.comp as NzSafeAny)['picker'].hideOverlay();\n    }\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { NzDatePickerModule } from 'ng-zorro-antd/date-picker';\n\nimport { RangePickerComponent } from './range.component';\n\nconst COMPONENTS = [RangePickerComponent];\n\n@NgModule({\n  imports: [CommonModule, FormsModule, NzDatePickerModule],\n  declarations: [...COMPONENTS],\n  exports: [...COMPONENTS],\n})\nexport class DatePickerModule {}\n"],"names":[],"mappings":"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"}